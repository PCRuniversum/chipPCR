<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Amplification curve simulator — AmpSim • chipPCR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Amplification curve simulator — AmpSim" />
<meta property="og:description" content="This function is a simple simulator of an amplification reaction based on a 
5-parameter Richards function. This simplified approach was chosen because it 
is impossible to model the shape of any amplification curve. An 
implementation of realistic models is ambitious and not conclusively 
addressed in the literature. First, they have to take ``all'' random 
effects of noise into consideration and second, they need to be generic 
enough to cover all amplification processes. More sophisticated mechanistic 
models and simulations have been proposed elsewhere mehra_2005, 
cobbs_2012. This approach of AmpSim is similar to the 
pcrsim function from the qpcR package, which offers 
simulations of sigmoidal qPCR data with goodness-of-fit analysis by 
Ritz and Spiess 2008." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chipPCR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/chipPCR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PCRuniversum/chipPCR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Amplification curve simulator</h1>
    
    <div class="hidden name"><code>AmpSim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a simple simulator of an amplification reaction based on a 
5-parameter Richards function. This simplified approach was chosen because it 
is impossible to model the shape of any amplification curve. An 
implementation of realistic models is ambitious and not conclusively 
addressed in the literature. First, they have to take ``all'' random 
effects of noise into consideration and second, they need to be generic 
enough to cover all amplification processes. More sophisticated mechanistic 
models and simulations have been proposed elsewhere <cite>mehra_2005, 
cobbs_2012</cite>. This approach of <code>AmpSim</code> is similar to the 
<code>pcrsim</code> function from the <em>qpcR</em> package, which offers 
simulations of sigmoidal qPCR data with goodness-of-fit analysis by 
Ritz and Spiess 2008.</p>
    </div>

    <pre class="usage"><span class='fu'>AmpSim</span><span class='op'>(</span>cyc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>35</span>, b.eff <span class='op'>=</span> <span class='op'>-</span><span class='fl'>25</span>, bl <span class='op'>=</span> <span class='fl'>0.05</span>, ampl <span class='op'>=</span> <span class='fl'>1</span>, Cq <span class='op'>=</span> <span class='fl'>20</span>, 
  noise <span class='op'>=</span> <span class='cn'>FALSE</span>, nnl <span class='op'>=</span> <span class='fl'>0.025</span>, nnl.method <span class='op'>=</span> <span class='st'>"constant"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cyc</th>
      <td><p>is a vector containing the cycle values.</p></td>
    </tr>
    <tr>
      <th>b.eff</th>
      <td><p>can be used to adjust the amplification efficiency.</p></td>
    </tr>
    <tr>
      <th>bl</th>
      <td><p>is used to define the base level (minimum) of the background range.</p></td>
    </tr>
    <tr>
      <th>ampl</th>
      <td><p>defines the plateau (maximum) of the amplification reaction.</p></td>
    </tr>
    <tr>
      <th>Cq</th>
      <td><p>defines approximately the quantification point (Cq) of the amplification 
    reaction.</p></td>
    </tr>
    <tr>
      <th>noise</th>
      <td><p>adds some noise to the amplification reaction.</p></td>
    </tr>
    <tr>
      <th>nnl</th>
      <td><p>level of noise during the amplification reaction.</p></td>
    </tr>
    <tr>
      <th>nnl.method</th>
      <td><p>trend of noise level during the amplification reaction. "constant" uses same
    noise of amplification, "decreasing" leads to less noise at the end of the 
    amplification reaction, and "increasing" leads to more noise at the end of 
    the amplification reaction.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>AmpSim</code> is a simple simulator for amplification reaction. 
This function has several parameters which can be used to simulate the 
amplification curve. <code>b.eff</code> and <code>Cq</code> are most connected with 
another. Thus changing one of them will change both values. <code>Cq</code> can be 
used to define an approximate Cq value. The expression "approximate Cq value" is 
used here because the actual Cq value is dependent on the users preferred method 
(e.g., Cy0 method, Second Derivative Maximum (SDM) method, threshold method). 
<code>AmpSim</code> can be used to compare an experimental system to a 
predicted model. Moreover it can be used to simulate data with noise, missing 
values (NA), signal-to-noise ratios, photo-bleaching and other influences on a 
PCR reaction.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>A Highly Versatile Microscope Imaging Technology Platform for the Multiplex 
Real-Time Detection of Biomolecules and Autoimmune Antibodies. S. Roediger, 
P. Schierack, A. Boehm, J. Nitschke, I. Berger, U. Froemmel, C. Schmidt, M. 
Ruhland, I. Schimke, D. Roggenbuck, W. Lehmann and C. Schroeder. 
<em>Advances in Biochemical Bioengineering/Biotechnology</em>. 133:33--74, 2013.</p>

<p>Ritz, C., Spiess, A.-N.: qpcR: an R package for sigmoidal model
selection in quantitative real-time polymerase chain reaction analysis.
<em>Bioinformatics</em> 24(13), 1549--1551 (2008).
doi:10.1093/bioinformatics/btn227. PMID: 18482995.</p>
<p>See also <code><a href='https://rdrr.io/pkg/qpcR/man/qpcR.news.html'>qpcR.news</a></code></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stefan Roediger, Michal Burdukiewicz</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example one</span>
<span class='co'># Simulate a qPCR reaction with AmpSim for 40 cycles.</span>
<span class='co'># Use an in-silico dilution of the template be adjusting </span>
<span class='co'># the Cq parameter. A change of 3.32 cycles corresponds </span>
<span class='co'># approximately to a 10-fold dilution.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>40</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>,<span class='fl'>2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, 
     ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, main <span class='op'>=</span> <span class='st'>"In-silco Dilution Experiment"</span><span class='op'>)</span>
<span class='va'>cycle.dilution</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>18</span>, <span class='fl'>35</span>, <span class='fl'>3.32</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'>AmpSim</span><span class='op'>(</span>cyc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>40</span>, b.eff <span class='op'>=</span> <span class='op'>-</span><span class='fl'>25</span>, bl <span class='op'>=</span> <span class='fl'>0.01</span>, ampl <span class='op'>=</span> <span class='fl'>2</span>, 
        Cq <span class='op'>=</span> <span class='va'>cycle.dilution</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, col <span class='op'>=</span> <span class='va'>i</span>, pch <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Example two</span>
<span class='co'># Simulate a qPCR reaction with AmpSim for 40 cycles and some noise.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>40</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>,<span class='fl'>2.2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, 
     ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, 
     main <span class='op'>=</span> <span class='st'>"In-silco Dilution Experiment with Some Noise"</span><span class='op'>)</span>
</div><div class='input'><span class='va'>cycle.dilution</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>18</span>, <span class='fl'>35</span>, <span class='fl'>3.32</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'>AmpSim</span><span class='op'>(</span>cyc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>40</span>, b.eff <span class='op'>=</span> <span class='op'>-</span><span class='fl'>25</span>, bl <span class='op'>=</span> <span class='fl'>0.01</span>, ampl <span class='op'>=</span> <span class='fl'>2</span>, 
        Cq <span class='op'>=</span> <span class='va'>cycle.dilution</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, noise <span class='op'>=</span> <span class='cn'>TRUE</span>, nnl <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>, 
        type <span class='op'>=</span> <span class='st'>"b"</span>, col <span class='op'>=</span> <span class='va'>i</span>, pch <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='AmpSim-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Example three</span>
<span class='co'># Apply constant, increasing, decreasing nose to </span>
<span class='co'># amplification data.</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>method</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"constant"</span>, <span class='st'>"increase"</span>, <span class='st'>"decrease"</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>40</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.02</span>,<span class='fl'>2.2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, 
  ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, 
  main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"In-silco Dilution Experiment with noise method: "</span>, 
              <span class='va'>method</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>cycle.dilution</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>18</span>, <span class='fl'>35</span>, <span class='fl'>3.32</span><span class='op'>)</span>
    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'>AmpSim</span><span class='op'>(</span>cyc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>40</span>, b.eff <span class='op'>=</span> <span class='op'>-</span><span class='fl'>25</span>, bl <span class='op'>=</span> <span class='fl'>0.02</span>, ampl <span class='op'>=</span> <span class='fl'>2</span>, 
       Cq <span class='op'>=</span> <span class='va'>cycle.dilution</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, noise <span class='op'>=</span> <span class='cn'>TRUE</span>, nnl <span class='op'>=</span> <span class='fl'>0.08</span>, 
       nnl.method <span class='op'>=</span> <span class='va'>method</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, col <span class='op'>=</span> <span class='va'>i</span>, pch <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
   <span class='op'>}</span>
<span class='op'>}</span>
</div><div class='img'><img src='AmpSim-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stefan Roediger, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


