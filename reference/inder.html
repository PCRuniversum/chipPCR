<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interpolate derivatives — inder • chipPCR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interpolate derivatives — inder" />
<meta property="og:description" content="A function inder (&quot;in&quot; + &quot;der&quot; = interpolate derivatives) for 
interpolating first and second derivatives using the five-point stencil. 
Therefore this function can be used to estimate the Cq (cycle of 
quantification) of an amplification curve. First positive derivative also 
known as First Derivative Maximum (FDM) and the Second Derivative Maximum 
(SDM) are calculated this way (Ruijter et al. 2013). However, from the 
mathematical point of view it can also be used to calculate the melting 
point for melting curve analysis (compare Roediger et al. 2013) provided 
that the sign of the derivative is changed." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chipPCR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/chipPCR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PCRuniversum/chipPCR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interpolate derivatives</h1>
    
    <div class="hidden name"><code>inder.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function <code>inder</code> ("in" + "der" = interpolate derivatives) for 
interpolating first and second derivatives using the five-point stencil. 
Therefore this function can be used to estimate the Cq (cycle of 
quantification) of an amplification curve. First positive derivative also 
known as First Derivative Maximum (FDM) and the Second Derivative Maximum 
(SDM) are calculated this way (Ruijter et al. 2013). However, from the 
mathematical point of view it can also be used to calculate the melting 
point for melting curve analysis (compare Roediger et al. 2013) provided 
that the sign of the derivative is changed.</p>
    </div>

    <pre class="usage"><span class='fu'>inder</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, Nip <span class='op'>=</span> <span class='fl'>4</span>, logy <span class='op'>=</span> <span class='cn'>FALSE</span>, smooth.method <span class='op'>=</span> <span class='st'>"spline"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>is a <code>numeric</code> vector of independent variable or data frame/matrix 
containing
abscissa and ordinate values.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>is a vector of dependent variable. Omitted if <code>x</code> is data frame or 
matrix.</p></td>
    </tr>
    <tr>
      <th>Nip</th>
      <td><p>is a value which defines how often an interpolation takes place at n 
equally 
spaced points spanning the interval (default 4). <code>Nip</code> is a such a 
resolution. A high <code>Nip</code> may improve the precision. <code>Nip</code>s less 
than 
2 and higher than 20 are not meaningful for conventional qPCR with up to 
50 cycles. However, higher <code>Nip</code>s might be appropriate for isothermal
amplification reactions.</p></td>
    </tr>
    <tr>
      <th>logy</th>
      <td><p>If <code>logy</code> is TRUE than a semi-decadic log scale graph (corresponds to 
the 
linear phase) to illustrate the exponential dynamic of the qPCR 
amplification
is used.</p></td>
    </tr>
    <tr>
      <th>smooth.method</th>
      <td><p>a character vector of length 1 or <code>NULL</code> defining smoothing method used. Currently 
accepted character values: "spline", "supsmu". If <code>NULL</code>, smoothing is not performed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>y = f(x)</code> is numerically derived using the five-point stencil. 
This method does not require any assumptions regarding the function <code>f</code>.</p>
<p>A smoothing procedure greatly enhances calculating derivative calculation. <code>inder</code>
uses two smoothing algorithms best suited for this approach. A smoothing can
be omitted by setting <code>smooth.method</code> to <code>NULL</code>, which is advisable in case of 
the already smoothed data.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of <code><a href='der.html'>der</a></code> class.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ruijter JM, Pfaffl MW, Zhao S, et al. (2013) Evaluation of qPCR curve 
analysis methods for reliable biomarker discovery: bias, resolution, 
precision, and implications. <em>Methods</em> San Diego Calif 59:32--46.</p>
<p>Surface Melting Curve Analysis with R. S. Roediger, A. Boehm and I. 
Schimke. <em>The R Journal</em>. 5(2):37--52, 2013. 
<a href='https://journal.r-project.org'>https://journal.r-project.org</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stefan Roediger, Michal Burdukiewicz</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># First example</span>
<span class='co'># Derive sinus</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>/</span><span class='fl'>10</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>ders</span> <span class='op'>&lt;-</span> <span class='fu'>inder</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>ders</span><span class='op'>[</span>, <span class='st'>"x"</span><span class='op'>]</span>, <span class='va'>ders</span><span class='op'>[</span>, <span class='st'>"d1y"</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>ders</span><span class='op'>[</span>, <span class='st'>"x"</span><span class='op'>]</span>, <span class='va'>ders</span><span class='op'>[</span>, <span class='st'>"d2y"</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topright"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"f(x)"</span>, <span class='st'>"f'(x)"</span>, <span class='st'>"f''(x)"</span><span class='op'>)</span>, lty <span class='op'>=</span> <span class='fl'>1</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"black"</span>, 
  <span class='st'>"red"</span>, <span class='st'>"green"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='inder-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Second example</span>
<span class='co'># Determine the approximate second derivative maximum</span>
<span class='co'># for a qPCR experiment. SDM, </span>
<span class='va'>isPCR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='AmpSim.html'>AmpSim</a></span><span class='op'>(</span>cyc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>)</span>

<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>inder</span><span class='op'>(</span><span class='va'>isPCR</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>isPCR</span>, xlab <span class='op'>=</span> <span class='st'>"Cycle"</span>, ylab <span class='op'>=</span> <span class='st'>"RFU"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.15</span>,<span class='fl'>1</span><span class='op'>)</span>,
     main <span class='op'>=</span> <span class='st'>"Approximate Second Derivative Maximum (SDM)"</span>, 
     type <span class='op'>=</span> <span class='st'>"b"</span>, pch <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
</div><div class='input'>
  <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>[</span>, <span class='st'>"x"</span><span class='op'>]</span>, <span class='va'>res</span><span class='op'>[</span>, <span class='st'>"d1y"</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
</div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>[</span>, <span class='st'>"x"</span><span class='op'>]</span>, <span class='va'>res</span><span class='op'>[</span>, <span class='st'>"d2y"</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'>  <span class='va'>summ</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span>, print <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDM"</span><span class='op'>]</span>, <span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDm"</span><span class='op'>]</span>, <span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDC"</span><span class='op'>]</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDM"</span><span class='op'>]</span>, <span class='fl'>0.5</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"SDM ~ "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDM"</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, 
       cex <span class='op'>=</span> <span class='fl'>1.5</span>, col <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDC"</span><span class='op'>]</span>, <span class='fl'>0.7</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"SDC ~ "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDC"</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, 
       cex <span class='op'>=</span> <span class='fl'>1.5</span>, col <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDm"</span><span class='op'>]</span>, <span class='fl'>0.9</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"SDm ~ "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"SDm"</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, 
       cex <span class='op'>=</span> <span class='fl'>1.5</span>, col <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"FDM"</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>10</span>, <span class='fl'>0.65</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"FDM ~ "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>summ</span><span class='op'>[</span><span class='st'>"FDM"</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, 
       cex <span class='op'>=</span> <span class='fl'>1.5</span>, col <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='input'>       
  <span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"raw"</span>, <span class='st'>"first derivative"</span>, <span class='st'>"second derivative"</span><span class='op'>)</span>, 
   col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>2</span><span class='op'>)</span>, lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, cex <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span>
</div><div class='img'><img src='inder-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stefan Roediger, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


