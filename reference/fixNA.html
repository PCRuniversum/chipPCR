<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Impute missing values into a column of amplification data — fixNA • chipPCR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Impute missing values into a column of amplification data — fixNA" />
<meta property="og:description" content="fixNA imputes missing values in a single 
column of data. The imputation is based on a linear approximation by default. 
However, the data can also be estimated from an approximation by splines." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chipPCR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/chipPCR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PCRuniversum/chipPCR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Impute missing values into a column of amplification data</h1>
    
    <div class="hidden name"><code>fixNA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>fixNA</code> imputes missing values in a single 
column of data. The imputation is based on a linear approximation by default. 
However, the data can also be estimated from an approximation by splines.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for numeric,numeric</span>
<span class='fu'>fixNA</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, spline <span class='op'>=</span> <span class='cn'>TRUE</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># S4 method for matrix,missing</span>
<span class='fu'>fixNA</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, spline <span class='op'>=</span> <span class='cn'>TRUE</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># S4 method for data.frame,missing</span>
<span class='fu'>fixNA</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, spline <span class='op'>=</span> <span class='cn'>TRUE</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>x</code> is a vector containing the time or cycle values or data frame/matrix where second 
    column contains missing data.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p><code>y</code> is a vector containing missing values. Used only if <code>x</code> is 
    also a vector.</p></td>
    </tr>
    <tr>
      <th>spline</th>
      <td><p><code>spline</code> if <code>TRUE</code> missing values are imputed by spline approximation as per 
	<code><a href='https://rdrr.io/r/stats/splinefun.html'>spline</a></code>. The default <code>FAlSE</code> is linear a approximation as 
	per <code><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>verbose</code> defines if the number of missing values should be reported.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Amplification data of experimental systems may contain missing values (NA). 
The NAs may be caused by detector problems, acquisition error or other 
assorted problems. There are different ways to handle missing values. One 
approach is to ignore NAs which is generally acceptable. However, in case of 
further calculation it is often necessary to handle cases of missing values in 
a way that the next calculation steps can be performed. Missing values can be 
eliminated by a imputation. Imputation encompasses various approaches. This 
includes to calculate a location parameter (e.g., mean, median) or other 
significant values (e.g., minimum, maximum, modus) of a data column. However, 
in non-linear processes such as amplification processes its is better to 
estimate the missing values from a trend. <code>fixNA</code> was empirically tested and relies on a linear 
trend estimation based on the <code><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></code> function. This 
approach is useful but may be problematic on the phases other then background 
or plateau phases of an amplification reaction. The parameter 
<code><a href='https://rdrr.io/r/stats/splinefun.html'>spline</a></code> on <code>fixNA</code> enables a trend 
estimation on splines and may be more appropriate in most scenarios. Other 
smoothing functions such as the Savitzky-Golay smoothing filter have the 
intrinsic capability to remove missing values [Savitzky and Golay 1964, 
Eilers 2003].</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Eilers, P. H. C. Anal. Chem. 2003, 75, 3631--3636.
  Savitzky, A.; Golay, M. J. E. Anal. Chem. 1964, 36, 1627--1639</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stefan Roediger, Michal Burdukiewicz</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></code>, <code><a href='https://rdrr.io/r/stats/splinefun.html'>spline</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simulate a qPCR reaction with AmpSim with for 40 cycles</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='AmpSim.html'>AmpSim</a></span><span class='op'>(</span>cyc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Introduce a missing value in the transition between </span>
<span class='co'># the background and the exponential phase</span>
<span class='va'>res.NA</span> <span class='op'>&lt;-</span><span class='va'>res</span>
<span class='va'>res.NA</span><span class='op'>[</span><span class='fl'>18</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, pch <span class='op'>=</span> <span class='fl'>20</span>, 
     main <span class='op'>=</span> <span class='st'>"Simulation without missing value"</span><span class='op'>)</span>
     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17.5</span>, <span class='fl'>18.5</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='fl'>0.14</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>

<span class='va'>res.NA.linear</span> <span class='op'>&lt;-</span> <span class='fu'>fixNA</span><span class='op'>(</span><span class='va'>res.NA</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, <span class='va'>res.NA</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, spline <span class='op'>=</span> <span class='cn'>FALSE</span>, 
           verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res.NA.linear</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, 
     pch <span class='op'>=</span> <span class='fl'>20</span>, main <span class='op'>=</span> <span class='st'>"Simulation with linear imputed\n NA 
     value during transition"</span><span class='op'>)</span>
     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17.5</span>, <span class='fl'>18.5</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='fl'>0.14</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res.NA</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, pch <span class='op'>=</span> <span class='fl'>20</span>, 
     main <span class='op'>=</span> <span class='st'>"Simulation with missing\n value during transition"</span><span class='op'>)</span>
     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17.5</span>, <span class='fl'>18.5</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='fl'>0.14</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
<span class='va'>res.NA.spline</span> <span class='op'>&lt;-</span> <span class='fu'>fixNA</span><span class='op'>(</span><span class='va'>res.NA</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, <span class='va'>res.NA</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, spline <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res.NA.spline</span>, xlab <span class='op'>=</span> <span class='st'>"Cycles"</span>, ylab <span class='op'>=</span> <span class='st'>"Fluorescence"</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, 
      pch <span class='op'>=</span> <span class='fl'>20</span>, main <span class='op'>=</span> <span class='st'>"Simulation with spline imputed\n NA value 
      during transition"</span><span class='op'>)</span>
</div><div class='input'>     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17.5</span>, <span class='fl'>18.5</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='input'>     <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='fl'>0.14</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>     
</div><div class='img'><img src='fixNA-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stefan Roediger, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


